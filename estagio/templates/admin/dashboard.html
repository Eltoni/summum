{% extends "admin/index.html" %}

{% load i18n admin_static %}
{% load nvd3_tags %}  
{% load geral_filters %}

{% block extrastyle %}
  {{ block.super }}

  {% include_chart_jscss %}
  {% load_chart charttype chartdata chartcontainer extra %}
{% endblock %}


{% block content %}
  <style>
    .alert-info {
      color: #31708f;
      background-color: #d9edf7;
      border-color: #bce8f1;
    }
    .alert-success {
        color: #3c763d;
        background-color: #dff0d8;
        border-color: #d6e9c6;
    }
    .alert {
        padding: 15px;
        margin-bottom: 20px;
        border: 1px solid transparent;
        border-radius: 4px;
    }

    .fonte-legenda {
        font-weight: normal;
        font-size: 12px;
        display: inline-block;
        line-height: normal;
        color: #999;
    }

    .module.blocks-content-main {
      margin: 0px 0px 15% 0px;
    }

    /* basic positioning */
    .legenda-produtos-esgotando { 
        list-style: none; 
    }
    .legenda-produtos-esgotando li { 
        float: left; margin-right: 10px; 
    }
    .legenda-produtos-esgotando span { 
        float: left; width: 12px; height: 12px; margin: 2px; 
    }

    /* colors */
    .legenda-produtos-esgotando .cinquenta-porcento { 
        background-color: #f2dede; border: 1px solid #f2dede;
    }
    .legenda-produtos-esgotando .cem-porcento { 
        background-color: #fcf8e3; border: 1px solid #fcf8e3;
    }
  </style>

  <div id="custom-dashboard">
      <div id="content-main">
        {% if perms.movimento.visualizar_rel_produtos_esgotando %}   {# Exibe apenas para usuários com permissão "Ver relatorio de produtos esgotando em estoque" #}
          {% if tab_limite_estoque %}
            {% if produtos_esgotando %}
              <div class="module blocks-content-main">
                <h4 class="italic-title" style="margin-left: 26px;"><b>{% trans 'Estoque' %}</b></h4>
                <h2><span class="description">{% trans 'Indicativo de Produtos esgotando em estoque' %}</span></h2>
                <!-- <table class="table-overview table table-striped table-bordered table-hover table-condensed"> -->
                <table class="table-overview table table-condensed">
                  <thead>
                    <tr>
                      <td></td>
                      <td>{% trans 'ID' %}</td>
                      <td>{% trans 'Produto' %}</td>
                      <td>{% trans 'Quantidade em estoque' %}</td>
                    </tr>
                  </thead>
                  <tbody>
                  {% for produtos in produtos_esgotando %}
                    <tr class='{{produtos.2|formata_quantidade_produtos:quantidade_minima}}'>
                      <td><span class="icon-pencil icon-alpha5"></span></td>
                      <td><a href="{% url 'admin:movimento_produtos_change' produtos.0 %}">{{ produtos.0 }}</a></td>
                      <td><a href="{% url 'admin:movimento_produtos_change' produtos.0 %}">{{ produtos.1 }}</a></td>
                      <td>{{ produtos.2 }}</td>
                    </tr>
                  {% endfor %}
                  </tbody>
                </table>
                <h2><span class="description">{% blocktrans %}Produtos com menos de {{ quantidade_minima }} itens em estoque.{% endblocktrans %}</span></h2>
                <ul class="legenda-produtos-esgotando">
                    <li>
                      <span class="cinquenta-porcento"></span> 
                      <font class="fonte-legenda">{% trans 'Abaixo de 50% da quantidade.' %}</font>
                    </li>
                    <br>
                    <li>
                      <span class="cem-porcento"></span>
                      <font class="fonte-legenda">{% trans 'Entre 50% e 100% da quantidade.' %}</font>
                    </li>
                </ul>
              </div>
            {% else %}
              <div class="module blocks-content-main alert alert-success">
                <h4 class="italic-title" style="margin-left: 26px;"><b>{% trans 'Estoque' %}</b></h4>
                <h2><span class="description">{% trans 'Não há produtos esgotando em estoque.' %}</span></h2>
              </div>
            {% endif %}
          {% endif %}
        {% endif %}
        {% if perms.movimento.visualizar_rel_debitos_creditos_diario %}   {# Exibe apenas para usuários com permissão "Ver relatorio de debitos e creditos diarios" #}
          <div class="blocks-content-main">
              {% if grafico_mov_dia %}
              <table>
                <tr>
                  <td>
                    <h4 class="italic-title" style="margin-left: 26px;"><b>{% trans 'Movimentação Financeira Diária' %}</b></h4>
                    <h2><span class="description">{% trans 'Demonstrativo diário de Débitos e Créditos movimentados em caixa' %}</span></h2>
                    {% include_container chartcontainer 500 1000 %}
                  </td>
                </tr>
              </table>

              <br>
              <table id="tabela_creditos_debitos" class="table table-striped table-bordered table-hover table-condensed" data-page-size="5">
                <thead>
                  <tr>
                    <td>Data</td>
                    <td>Crédito (R$)</td>
                    <td>Débito (R$)</td>
                  </tr>
                </thead>
                <tbody>
                {% for d, cr, de in table_creditos_debitos %}
                  <tr>
                    <td>{{ d }}</td>
                    <td>{{ cr }}</td>
                    <td>{{ de }}</td>
                  </tr>
                {% endfor %}
                </tbody>
                <tfoot>
                  <tr>
                    <td colspan="3">
                      <div class="pagination pagination-centered hide-if-no-paging"></div>
                    </td>
                  </tr>
                </tfoot>
              </table>
              <script type="text/javascript">
                $(function () {
                  $('#tabela_creditos_debitos').footable();

                    $('#change-page-size').change(function (e) {
                      e.preventDefault();
                      var pageSize = $(this).val();
                      $('.footable').data('page-size', pageSize);
                      $('.footable').trigger('footable_initialized');
                    });

                    $('#change-nav-size').change(function (e) {
                      e.preventDefault();
                      var navSize = $(this).val();
                      $('.footable').data('limit-navigation', navSize);
                      $('.footable').trigger('footable_initialized');
                    });
                  });
              </script>
              {% endif %}
          </div>
        {% endif %}
      </div>
    
  </div>

{% endblock %}


{% block sidebar %}
{% endblock %}